<!-- Leyenda de daños reutilizable -->
<div class="mt-3 p-3 bg-light rounded">
  <h6 class="mb-3"><strong>Leyenda de Hallazgos Odontológicos (símbolos)</strong></h6>
  <div class="row g-2">
    <!-- Símbolos visuales (todos los dibujables) -->
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="1" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>1 -</strong> Caries (cuadro rojo)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="11" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>11 -</strong> Obturación (cuadro azul)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="2" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>2 -</strong> Corona Definitiva (círculo azul)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="3" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>3 -</strong> Corona Temporal (círculo rojo)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="4" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>4 -</strong> Diente Ausente (X azul)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="5" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>5 -</strong> Fractura (línea roja)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="8" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>8 -</strong> Diastema (dos arcos)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="9" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>9 -</strong> Diente Extruido (flecha afuera)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="10" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>10 -</strong> Diente en Clavija (triángulo)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="12" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>12 -</strong> Prótesis Removible (doble línea)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="13" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>13 -</strong> Migración (flecha)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="14" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>14 -</strong> Giroversión (semicírculo)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="15" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>15 -</strong> Fusión (elipse)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="16" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>16 -</strong> Rem. Radicular (RR)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="20" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>20 -</strong> Diente Intruido (flecha adentro)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="23" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>23 -</strong> Ortod. Removible (zig-zag)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="24" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>24 -</strong> Diente en Erupción (V + zig-zag)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="25" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>25 -</strong> Transposición Izq.</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="26" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>26 -</strong> Transposición Der.</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="27" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>27 -</strong> Supernumerario (S)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="28" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>28 -</strong> Pulpar (línea vertical)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="29" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>29 -</strong> Prótesis Total (doble línea)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="30" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>30 -</strong> Perno Muñón</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="31" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>31 -</strong> Edéntulo Total (línea)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="32" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>32 -</strong> Ortod. Fijo (extremo)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="33" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>33 -</strong> Ortod. Fijo (centro)</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="34" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>34 -</strong> Prótesis Fija Izq.</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="35" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>35 -</strong> Prótesis Fija Centro</small>
    </div>
    <div class="col-md-4 d-flex align-items-center">
      <canvas class="legend-icon" data-damage="36" width="30" height="30" style="border:1px solid #ddd; margin-right:8px;"></canvas>
      <small><strong>36 -</strong> Prótesis Fija Der.</small>
    </div>
  </div>
  <div class="mt-3 p-2 bg-white rounded border">
    <small class="text-muted">
      <strong>Referencias representadas con texto:</strong><br>
      • 6-IMP (Implante) | 17-MAC (Macrodoncia) | 18-MIC (Microdoncia) | 19-I (Impactación)<br>
      • 21-E (Diente Ectópico) | 22-DIS (Diente Discrómico) | 37-DES (Superficie Desgastada) | 38-SI (Semi-Impactación)
    </small>
  </div>
</div>

<!-- Script para dibujar iconos en la leyenda -->
<script>
  // Función global para dibujar iconos de leyenda (simple, sin dependencias)
  window.drawLegendIcon = function(canvas, damageId) {
    const ctx = canvas.getContext('2d');
    const w = canvas.width, h = canvas.height, cx = w/2, cy = h/2;
    
    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, w, h);
    
    switch(damageId) {
      case 1: ctx.fillStyle='#F00'; ctx.fillRect(cx-8,cy-8,16,16); break;
      case 2: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cx,cy,10,0,Math.PI*2); ctx.stroke(); break;
      case 3: ctx.strokeStyle='#F00'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cx,cy,10,0,Math.PI*2); ctx.stroke(); break;
      case 4: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(5,5); ctx.lineTo(w-5,h-5); ctx.moveTo(w-5,5); ctx.lineTo(5,h-5); ctx.stroke(); break;
      case 5: ctx.strokeStyle='#F00'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(5,h-5); ctx.lineTo(w-5,5); ctx.stroke(); break;
      case 8: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cx+7,cy+4,6,Math.PI*0.5,Math.PI*1.5); ctx.stroke(); ctx.beginPath(); ctx.arc(cx-7,cy+4,6,Math.PI*0.5,Math.PI*1.5,true); ctx.stroke(); break;
      case 9: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(cx,6); ctx.lineTo(cx,16); ctx.moveTo(cx-6,10); ctx.lineTo(cx,4); ctx.lineTo(cx+6,10); ctx.stroke(); break;
      case 10: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(6,h-6); ctx.lineTo(cx,8); ctx.lineTo(w-6,h-6); ctx.closePath(); ctx.stroke(); break;
      case 11: ctx.fillStyle='#00F'; ctx.fillRect(cx-8,cy-8,16,16); break;
      case 12: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(4,cy-3); ctx.lineTo(w-4,cy-3); ctx.moveTo(4,cy+3); ctx.lineTo(w-4,cy+3); ctx.stroke(); break;
      case 13: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(5,cy); ctx.lineTo(w-5,cy); ctx.lineTo(w-10,cy-5); ctx.moveTo(w-5,cy); ctx.lineTo(w-10,cy+5); ctx.stroke(); break;
      case 14: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cx,cy,8,Math.PI,Math.PI*2); ctx.stroke(); ctx.beginPath(); ctx.moveTo(cx+8,cy); ctx.lineTo(cx+3,cy); ctx.moveTo(cx+8,cy); ctx.lineTo(cx+8,cy-5); ctx.stroke(); break;
      case 15: ctx.strokeStyle='#00F'; ctx.lineWidth=2; if(ctx.ellipse){ctx.beginPath(); ctx.ellipse(cx,cy,12,6,0,0,Math.PI*2); ctx.stroke();} else {ctx.beginPath(); ctx.arc(cx,cy,10,0,Math.PI*2); ctx.stroke();} break;
      case 16: ctx.fillStyle='#F00'; ctx.font='bold 12px Arial'; ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('RR',cx,cy); break;
      case 20: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(cx,h-6); ctx.lineTo(cx,h-16); ctx.moveTo(cx-6,h-10); ctx.lineTo(cx,h-4); ctx.lineTo(cx+6,h-10); ctx.stroke(); break;
      case 23: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(4,cy); ctx.lineTo(cx,cy-6); ctx.lineTo(w-4,cy); ctx.stroke(); break;
      case 24: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(6,h-10); ctx.lineTo(cx,h-4); ctx.lineTo(w-6,h-10); ctx.moveTo(cx,h-4); ctx.lineTo(cx,h-10); ctx.lineTo(8,h-16); ctx.lineTo(w-8,h-22); ctx.lineTo(8,h-28); ctx.stroke(); break;
      case 25: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); if(ctx.ellipse){ctx.ellipse(cx+6,6,12,4,0,Math.PI,Math.PI*2);} else {ctx.moveTo(4,10); ctx.lineTo(w-4,10);} ctx.stroke(); ctx.beginPath(); ctx.moveTo(w-6,6); ctx.lineTo(w-6,2); ctx.moveTo(w-6,6); ctx.lineTo(w-10,6); ctx.stroke(); break;
      case 26: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); if(ctx.ellipse){ctx.ellipse(cx-6,6,12,4,0,Math.PI,Math.PI*2);} else {ctx.moveTo(4,10); ctx.lineTo(w-4,10);} ctx.stroke(); ctx.beginPath(); ctx.moveTo(6,6); ctx.lineTo(6,2); ctx.moveTo(6,6); ctx.lineTo(10,6); ctx.stroke(); break;
      case 27: ctx.strokeStyle='#00F'; ctx.fillStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(cx,cy,8,0,Math.PI*2); ctx.stroke(); ctx.font='bold 12px Arial'; ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('S',cx,cy); break;
      case 28: ctx.strokeStyle='#00F'; ctx.lineWidth=3; ctx.beginPath(); ctx.moveTo(cx,5); ctx.lineTo(cx,h-5); ctx.stroke(); break;
      case 29: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(4,h-8); ctx.lineTo(w-4,h-8); ctx.moveTo(4,h-12); ctx.lineTo(w-4,h-12); ctx.stroke(); break;
      case 30: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.rect(cx-6,cy-6,12,12); ctx.moveTo(cx,cy+6); ctx.lineTo(cx,h-4); ctx.stroke(); break;
      case 31: ctx.strokeStyle='#00F'; ctx.lineWidth=3; ctx.beginPath(); ctx.moveTo(4,cy); ctx.lineTo(w-4,cy); ctx.stroke(); break;
      case 32: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.rect(6,6,w-12,h-12); ctx.moveTo(cx,6); ctx.lineTo(cx,h-6); ctx.moveTo(8,cy); ctx.lineTo(w-8,cy); ctx.stroke(); break;
      case 33: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(4,cy); ctx.lineTo(w-4,cy); ctx.stroke(); break;
      case 34: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(cx,6); ctx.lineTo(cx,14); ctx.lineTo(6,14); ctx.stroke(); break;
      case 35: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(6,14); ctx.lineTo(w-6,14); ctx.stroke(); break;
      case 36: ctx.strokeStyle='#00F'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(cx,6); ctx.lineTo(cx,14); ctx.lineTo(w-6,14); ctx.stroke(); break;
    }
  };

  // Auto-ejecutar al cargar la página
  window.addEventListener('DOMContentLoaded', function(){
    document.querySelectorAll('.legend-icon').forEach(canvas => {
      const damageId = parseInt(canvas.getAttribute('data-damage'));
      window.drawLegendIcon(canvas, damageId);
    });
  });
</script>
